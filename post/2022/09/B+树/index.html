<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.38">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/img/logo-broccoli.png"><title>8分钟，复习一遍B树，B+树！ | pixel-revolve</title><meta name="description" content="爱编程，爱生活">
    <link rel="modulepreload" href="/assets/app.9fd9aa02.js"><link rel="modulepreload" href="/assets/index.html.94022e1c.js"><link rel="modulepreload" href="/assets/index.html.1d2b0727.js">
    <link rel="stylesheet" href="/assets/style.2781e754.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container no-sidebar"><!--[--><header class="navbar invert"><span><a href="/" class=""><span class="site-name">$ cd /home/</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="Home"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 20 20" fill="currentColor"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"/></svg></span><span>Home</span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/tags/" class="" aria-label="Tags"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M17.707 9.293a1 1 0 010 1.414l-7 7a1 1 0 01-1.414 0l-7-7A.997.997 0 012 10V5a3 3 0 013-3h5c.256 0 .512.098.707.293l7 7zM5 6a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/></svg></span><span>Tags</span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/links/" class="" aria-label="Links"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"/></svg></span><span>Links</span><!--[--><!--]--></a></div><!--]--><div class="navbar-item"><a style="cursor:pointer;"><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 24 24" fill="currentColor"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 2c4.968 0 9 4.032 9 9s-4.032 9-9 9-9-4.032-9-9 4.032-9 9-9zm0 16c3.867 0 7-3.133 7-7 0-3.868-3.133-7-7-7-3.868 0-7 3.132-7 7 0 3.867 3.132 7 7 7zm8.485.071l2.829 2.828-1.415 1.415-2.828-2.829 1.414-1.414z"/></svg></span><span>Search</span></a></div></nav><!--[--><!--]--><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="Home"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 20 20" fill="currentColor"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"/></svg></span><span>Home</span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/tags/" class="" aria-label="Tags"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M17.707 9.293a1 1 0 010 1.414l-7 7a1 1 0 01-1.414 0l-7-7A.997.997 0 012 10V5a3 3 0 013-3h5c.256 0 .512.098.707.293l7 7zM5 6a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/></svg></span><span>Tags</span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/links/" class="" aria-label="Links"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"/></svg></span><span>Links</span><!--[--><!--]--></a></div><!--]--><div class="navbar-item"><a style="cursor:pointer;"><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 24 24" fill="currentColor"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 2c4.968 0 9 4.032 9 9s-4.032 9-9 9-9-4.032-9-9 4.032-9 9-9zm0 16c3.867 0 7-3.133 7-7 0-3.868-3.133-7-7-7-3.868 0-7 3.132-7 7 0 3.867 3.132 7 7 7zm8.485.071l2.829 2.828-1.415 1.415-2.828-2.829 1.414-1.414z"/></svg></span><span>Search</span></a></div></nav><!--[--><!--]--><!----><!--[--><!--]--></aside><!--]--><div class="page-content"><!--[--><div class="show-catalog post-wrapper"><div class="article-header use-image post-header" style="background-image:url(/img/blog_cover/2022/09/8分钟，复习一遍B树，B+树！.jpg);"><div class="article-header-mask" style="background:rgba(40, 57, 101, .4);"></div><div class="article-header-content"><div class="article-tags"><!--[--><span class="article-tag">数据结构</span><!--]--></div><h1 class="article-title">8分钟，复习一遍B树，B+树！</h1><p class="article-subtitle">数据库等底层偏爱的数据结构</p><div class="article-icons"><div class="article-icon"><svg class="ov-icon" style="font-size:1.08em;" aria-hidden="true" width="17.28" height="17.28" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor"><path d="M313.6 304c-28.7 0-42.5 16-89.6 16-47.1 0-60.8-16-89.6-16C60.2 304 0 364.2 0 438.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-25.6c0-74.2-60.2-134.4-134.4-134.4zM400 464H48v-25.6c0-47.6 38.8-86.4 86.4-86.4 14.6 0 38.3 16 89.6 16 51.7 0 74.9-16 89.6-16 47.6 0 86.4 38.8 86.4 86.4V464zM224 288c79.5 0 144-64.5 144-144S303.5 0 224 0 80 64.5 80 144s64.5 144 144 144zm0-240c52.9 0 96 43.1 96 96s-43.1 96-96 96-96-43.1-96-96 43.1-96 96-96z"/></svg><span>pixel-revolve</span></div><div class="article-icon"><svg class="ov-icon" style="font-size:1.08em;" aria-hidden="true" width="17.28" height="17.28" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor"><path d="M400 64h-48V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H160V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zm-6 400H54c-3.3 0-6-2.7-6-6V160h352v298c0 3.3-2.7 6-6 6z"/></svg><span>2022-09-22</span></div><div class="article-icon"><svg class="ov-icon" style="font-size:1.08em;" aria-hidden="true" width="17.28" height="17.28" viewBox="0 0 24 24" fill="currentColor"><path fill="none" d="M0 0h24v24H0z"/><path d="M17.618 5.968l1.453-1.453 1.414 1.414-1.453 1.453a9 9 0 11-1.414-1.414zM12 20a7 7 0 100-14 7 7 0 000 14zM11 8h2v6h-2V8zM8 1h8v2H8V1z"/></svg><span>36 min</span></div></div></div><!----></div><main class="page post-content"><!--[--><!--]--><div class="theme-gungnir-content"><!--[--><h1 id="简单介绍" tabindex="-1"><a class="header-anchor" href="#简单介绍" aria-hidden="true">#</a> 简单介绍</h1><h2 id="什么是b树-b-树" tabindex="-1"><a class="header-anchor" href="#什么是b树-b-树" aria-hidden="true">#</a> 什么是B树，B+树？</h2><blockquote><p>B 树</p></blockquote><p><strong>B 树(B- 树)</strong> 指的是 Balance Tree，又名平衡多路（即不止两个子树）查找树，并且所有叶子节点位于同一层。</p><blockquote><p>B+ 树</p></blockquote><p><strong>B+ 树</strong>基于B 树和叶子节点顺序访问指针进行实现，具有 B 树的平衡性，并且通过顺序访问指针来提高区间查询的性能。通常用于数据库和操作系统的文件系统中。</p><p>B+ 树的特点是能够保持数据稳定有序，其插入与修改拥有较稳定的对数时间复杂度。B+ 树元素自底向上插入，这与二叉树恰好相反。</p><h2 id="b树-b-树的使用场景" tabindex="-1"><a class="header-anchor" href="#b树-b-树的使用场景" aria-hidden="true">#</a> B树，B+树的使用场景</h2><blockquote><p>文件系统和数据库系统中常用的B/B+ 树，他通过对每个节点存储个数的扩展，使得对连续的数据能够进行较快的定位和访问，能够有效减少查找时间，提高存储的空间局部性从而减少IO操作。他广泛用于<strong>文件系统及数据库</strong>中，如：</p></blockquote><ul><li><code>Windows</code>：<code>HPFS</code> 文件系统</li><li><code>Mac</code>：<code>HFS</code>，<code>HFS+</code> 文件系统</li><li><code>Linux</code>：<code>ResiserFS</code>，<code>XFS</code>，<code>Ext3FS</code>，<code>JFS</code> 文件系统</li><li>数据库：<code>ORACLE</code>，<code>MYSQL</code>，<code>SQLSERVER</code> 等中</li><li>数据库：<code>ORACLE</code>，<code>MYSQL</code>，<code>SQLSERVER</code> 等中</li></ul><blockquote><p>具体一点</p></blockquote><ul><li>B树 <ul><li><code>MongoDB</code>数据库使用，单次查询平均快于<code>MySQL</code> (但侧面来看<code>MySQL</code>至少平均查询耗时差不多)</li><li><code>ORACLE</code>数据库</li></ul></li><li>B+树 <ul><li><code>MySQL</code>数据库普遍使用B+树来实现索引结构 <ul><li><code>MyISAM</code>索引实现</li><li><code>InnoDB</code>索引实现</li></ul></li></ul></li></ul><blockquote><p>这里注意了，<code>Redis</code> 用的是 <code>skiplist</code>(跳表) 作为底层，而没有使用平衡树这一结构</p></blockquote><h2 id="磁盘概述" tabindex="-1"><a class="header-anchor" href="#磁盘概述" aria-hidden="true">#</a> 磁盘概述</h2><blockquote><p>现在我们知道了B，B+树主要用在文件系统和数据库了。本篇我们将简单的介绍磁盘这个存储结构，为接下来的学习做铺垫。</p></blockquote><blockquote><p>磁盘结构示意图</p></blockquote><ul><li><p>整体结构</p><p><img src="https://pixel-revolve.oss-cn-hangzhou.aliyuncs.com/img/image-20220922110134395.png" alt="image-20220922110134395"></p></li><li><p>横切面</p><p><img src="https://pixel-revolve.oss-cn-hangzhou.aliyuncs.com/img/image-20220922110831001.png" alt="image-20220922110831001"></p></li></ul><blockquote><p>我们都知道，计算机的存储管理是分层的，各层次之间的速度差距比较大，尤其是辅存（磁盘）和主存之间的速度。我们也知道磁盘访问比较慢，为什么会慢呢？</p></blockquote><ul><li><blockquote><p>关于访存</p></blockquote><p>CPU访问磁盘时，磁盘主要干了这些事：</p><pre><code> 1. **寻道**：磁头摆一摆，找到对应的柱面
 2. **定位**：盘面转一转，磁头定位到指定扇区
</code></pre></li></ul><p>在访存的两个步骤中，因为是机械操作比不上主存的电信号传播，所以自然就慢了不少，磁盘访问慢了，访问效率自然就跟不上了。</p><blockquote><p>那么能不能再不改变这种机械运动的情况下提升访存效率呢？</p></blockquote><p>能。使用索引就可以。</p><ul><li><blockquote><p>什么是索引？</p></blockquote><p>索引就好比是书的目录，比如当我们查看一本字典的时候，目录就相当于我们的<strong>对照表</strong>。索引一般以文件形式存储在磁盘上，索引检索需要磁盘I/O操作。</p></li></ul><p>所以这就要求我们建立一个好的索引来帮助我们提升访存效率。</p><blockquote><p>磁盘读写原理</p></blockquote><ul><li><p><strong>局部性原理</strong></p><p>在一小段时间里，程序执行所访问的存储空间局限于<strong>某个内存区域</strong>。(在这一小段时间内程序只会用这一部分内存的这一小撮数据)</p></li><li><p><strong>磁盘预读</strong></p><p>在有了局部性原理之后。这程序执行依次要一个数据，现在我们知道它要的数据基本都是一堆一堆的凑在一起的，那我就可以在它要之前我这个磁盘先读着我这个扇区下面的内容，不管程序是否需要。这个就是磁盘预读，预读的长度一般为页（page）的整数倍。（页是数据存储的单位。页面从主存储器加载到处理器中。页由单元块或块组组成。）</p></li></ul><blockquote><p>在了解了磁盘以后，我们知道问题是如何利用索引来提高访存速度。而B，B+树就是为了解决这个问题而存在的。</p></blockquote><h2 id="为什么使用b-b-树" tabindex="-1"><a class="header-anchor" href="#为什么使用b-b-树" aria-hidden="true">#</a> 为什么使用B，B+树？</h2><p>传统用来搜索的平衡二叉树有很多，如 AVL 树，红黑树等。这些树在一般情况下查询性能非常好，<strong>但当数据非常大的时候它们就无能为力</strong>了。（这些树的高度比较高）</p><p>原因当数据量非常大时，内存不够用，大部分数据只能存放在磁盘上，只有需要的数据才加载到内存中。一般而言内存访问的时间约为 50 ns，而磁盘在 10 ms 左右。速度相差了近 5 个数量级，磁盘读取时间远远超过了数据在内存中比较的时间。这说明程序大部分时间会阻塞在磁盘 IO 上。</p><p>那么我们如何提高程序性能？减少磁盘 IO 次数，像 AVL 树，红黑树这类平衡二叉树从设计上无法“迎合”磁盘。</p><p>**平衡二叉树是通过旋转来保持平衡的，而旋转是对整棵树的操作，若部分加载到内存中则无法完成旋转操作。**其次平衡二叉树的高度相对较大为 log n（底数为2），<strong>这样逻辑上很近的节点实际可能非常远，无法很好的利用磁盘预读（局部性原理）</strong>。</p><p>在最坏的情况下，一次IO就只能获得一个结点的值，所以在最坏的情况下，不管是红黑树还是AVL树、B树、B+树，他们对应的磁盘操作是树的高度。而B树和B+树的高度是低的，适应数据库和文件系统的。</p><p>所以 AVL 树，红黑树这类平衡二叉树在数据库和文件系统上的选择就被 pass 了。</p><blockquote><p>更多细节将在 “剖析 B树，B+树” 章节解释</p></blockquote><h1 id="b树-b-树的特征" tabindex="-1"><a class="header-anchor" href="#b树-b-树的特征" aria-hidden="true">#</a> B树，B+树的特征</h1><blockquote><p>本篇为对B树和B+树的特征列举, 详细的部分在下一章对比中给出</p></blockquote><blockquote><p>B 树的特征</p></blockquote><ul><li><blockquote><p>一个m阶的B树有如下几个特征：</p></blockquote><ul><li><p>若根结点不是终端结点，则至少有2棵子树。</p></li><li><p>每个中间节点都包含k-1个元素和k个孩子，其中 m/2 &lt;= k &lt;= m</p></li><li><p>每一个叶子节点都包含k-1个元素，其中 m/2 &lt;= k &lt;= m</p></li><li><p>所有的叶子结点都位于同一层。</p></li><li><p>每个节点中的元素从小到大排列，节点当中k-1个元素正好是k个孩子包含的元素的值域分划。</p></li></ul></li><li><blockquote><p>B 树(3阶)示例:</p></blockquote><p><img src="https://pixel-revolve.oss-cn-hangzhou.aliyuncs.com/img/image-20220920203106427.png" alt="image-20220920203106427"></p></li></ul><blockquote><p>B+ 树的特征</p></blockquote><ul><li><blockquote><p>一棵m阶B+树具有如下几个特征：</p></blockquote><ul><li>有k个子树的中间节点包含有k个元素（B树中是k-1个元素），每个元素不保存数据，只用来索引，所有数据都保存在叶子节点。</li><li>所有的叶子结点中包含了全部元素的信息，及指向含这些元素记录的指针，且叶子结点本身依关键字的大小自小而大顺序链接。</li><li>所有的中间节点元素都同时存在于子节点，在子节点元素中是最大（或最小）元素。</li></ul></li><li><blockquote><p>B+ 树(3阶)示例：</p></blockquote><p><img src="https://pixel-revolve.oss-cn-hangzhou.aliyuncs.com/img/image-20220921152142893.png" alt="image-20220921152142893"></p><blockquote><p>解释：</p></blockquote><p>B+ 树始终要保持最大元素在根节点当中。</p><p>B+ 树的叶子节点包含了全量元素信息。并且每一个叶子节点都带有指向下一个节点的指针，形成了一个<strong>有序链表</strong>。</p></li></ul><blockquote><p>无论是B树还是B+树，最底层呈现的都是有序序列。</p></blockquote><h1 id="avl树-vs-b树-vs-b-树" tabindex="-1"><a class="header-anchor" href="#avl树-vs-b树-vs-b-树" aria-hidden="true">#</a> AVL树 vs B树 vs B+树</h1><blockquote><p>关于平衡二叉树的内容可以看我的另一篇博客：https://juejin.cn/post/7136389871266070564</p></blockquote><blockquote><p>AVL 树（左），B 树（右）</p></blockquote><p><img src="https://pixel-revolve.oss-cn-hangzhou.aliyuncs.com/img/image-20220921141358352.png" alt="image-20220921141358352"></p><ul><li><p><strong>B树的节点和AVL树的节点结构不同</strong></p><p>平衡二叉树的节点，每个最多有一个数据和最多两个子树。</p><p>B树的节点，每个节点可以有不止一个数据，同时可以拥有的子树数量是阶数决定的。</p></li><li><p><strong>B树的查找效率更高</strong></p><p>B树的每个节点可以表示的信息更多，因此整个树更加“矮胖”，这在从磁盘中查找数据（先读取到内存、后查找）的过程中，可以减少磁盘 IO 的次数，从而提升查找速度。</p></li></ul><blockquote><p>B树既然这么多好处了，那么B+树呢？</p></blockquote><blockquote><p>B 树（上），B+树（下）</p></blockquote><p><img src="https://pixel-revolve.oss-cn-hangzhou.aliyuncs.com/img/image-20220921143028652.png" alt="image-20220921143028652"></p><ul><li><p><strong>B+树的磁盘读写代价更低</strong>(节点结构不同决定)</p><p>B+树的非叶子节点不存储数据，所以其内部结点相对B树更小，如果把所有同一非叶子结点的关键字存放在同一盘块中，那么盘块所能容纳的关键字数量也越多。相对来说IO读写次数也就降低了，查找速度更快了。</p></li><li><p><strong>B+树查询效率更稳定</strong></p><p>**B+树内非叶子节点不存储数据，而是只是叶子结点关键字的索引，所有 data 存储在叶节点导致查询时间复杂度固定为 log n。而B-树查询时间复杂度不固定，与 key 在树中的位置有关，最好为O(1)。**所以B+树中任何关键字的查找必须走一条从根结点到叶子结点的路，所有关键字查询的路径长度相同，导致每一个数据的查询效率相当，而对于B树来说，因为每个结点都存有具体的数据，因此其查询速度不稳定，可能很快也可能很慢。</p><blockquote><p>举个例子：</p><p>我们查询 9 这个元素，从上图可以看出，key 为 9 的节点就在第一层，B树只需要一次磁盘 IO 即可完成查找。所以说B树的查询最好时间复杂度是 O(1)。由于B+树所有的 data 域都在根节点，所以查询 key 为 9的节点必须从根节点索引到叶节点，时间复杂度固定为 O(log n)。</p></blockquote></li><li><p><strong>B+树便于范围查询</strong></p><p><strong>B树在提高了IO性能的同时，并没有解决元素遍历效率低下的问题。为了解决这个问题，B+树应运而生。</strong></p><p>B+树只需要遍历叶子结点就可以实现整棵树的遍历（B+树叶子结点维护有序链表。在数据库中基于范围的查找也是非常频繁的，因此<code>MySQL</code>的<code>Innodb</code>引擎就使用了B+树作为其索引的数据结构</p></li></ul><h1 id="深入剖析-b树-b-树" tabindex="-1"><a class="header-anchor" href="#深入剖析-b树-b-树" aria-hidden="true">#</a> 深入剖析 B树，B+树</h1><h2 id="卫星数据" tabindex="-1"><a class="header-anchor" href="#卫星数据" aria-hidden="true">#</a> 卫星数据</h2><blockquote><p>什么是卫星数据？</p></blockquote><p>卫星数据指<strong>索引元素所指向的数据记录</strong>，</p><p>比如数据库中的某一行。</p><p>在B树中，无论非叶子结点还是叶子结点都带有卫星数据；</p><p><img src="https://pixel-revolve.oss-cn-hangzhou.aliyuncs.com/img/image-20220922134010842.png" alt="image-20220922134010842"></p><p>而在B+树中只有叶子结点带有卫星数据，其余非终端结点仅仅是索引，没有任何数据关联。</p><p><img src="https://pixel-revolve.oss-cn-hangzhou.aliyuncs.com/img/image-20220922134231164.png" alt="image-20220922134231164"></p><blockquote><p>拿MySQL中的聚簇索引和非聚簇索引举例</p></blockquote><p>在MySQL数据库的聚簇索引中，叶子结点直接包含卫星数据；在非聚簇索引中，叶子结点带有指向卫星数据的指针。</p><h2 id="b-树" tabindex="-1"><a class="header-anchor" href="#b-树" aria-hidden="true">#</a> B 树</h2><h3 id="_23树-234树" tabindex="-1"><a class="header-anchor" href="#_23树-234树" aria-hidden="true">#</a> 23树，234树</h3><blockquote><p>在我的文章：<a href="https://juejin.cn/post/7136831545557385224" target="_blank" rel="noopener noreferrer">8分钟，复习一遍红黑树！</a>中，我介绍了红黑树的前身——234树，而<strong>实际上234树就是4阶B树，23树就是3阶B树</strong>！</p><p><strong>这样一来，本章的目的之一 “对B树的剖析” 就不是难事了。</strong></p></blockquote><ul><li>234树（4阶B树）：是一种多叉树，它的每个节点最多有3个数据项和4个子节点。</li><li>23树（3阶B树）：是一种多叉树，它的每个节点最多有2个数据项和3个子节点。</li></ul><p><strong>所以，B树的插入以及删除等操作完全就可以用234树，23树来解释。</strong></p><blockquote><p>下一个篇章我们将介绍B树的常见操作。</p></blockquote><h3 id="b-树的操作" tabindex="-1"><a class="header-anchor" href="#b-树的操作" aria-hidden="true">#</a> B 树的操作</h3><h4 id="插入" tabindex="-1"><a class="header-anchor" href="#插入" aria-hidden="true">#</a> 插入</h4><blockquote><p>关于234树的插入操作在<a href="https://juejin.cn/post/7136831545557385224" target="_blank" rel="noopener noreferrer">8分钟，复习一遍红黑树！</a>中已经详细说明，这里就不展开了。</p></blockquote><h4 id="查找" tabindex="-1"><a class="header-anchor" href="#查找" aria-hidden="true">#</a> 查找</h4><p><img src="https://pixel-revolve.oss-cn-hangzhou.aliyuncs.com/img/image-20220922132426635.png" alt="image-20220922132426635"></p><p>假设每个节点有 n 个 key值，被分割为 n+1 个区间，注意，B树的 key 和 data 实际是聚合在一起的，因为B树的所有节点都是<strong>卫星数据</strong>！</p><p>一般而言，根节点都在内存中，B树以每个节点为一次磁盘 IO。</p><p>比如上图中，若搜索 key 为 3 节点的 data，首先在根节点进行二分查找（因为 keys 有序，二分最快），判断 key 3 小于 key 5，所以定位到最左侧的节点，此时进行一次磁盘 IO，将该节点从磁盘读入内存，接着继续进行上述过程，直到找到该 key 为止。</p><p>查找伪代码：</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Node</span><span class="token operator">*</span> <span class="token class-name">BTreeSearch</span><span class="token punctuation">(</span><span class="token class-name">Root</span> <span class="token operator">*</span>root<span class="token punctuation">,</span> <span class="token class-name">Key</span> key<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">Node</span><span class="token operator">*</span> node<span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    node <span class="token operator">=</span> <span class="token class-name">BinarySearch</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 在根节点进行二分查找，进行当前节点定位</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token operator">-&gt;</span>key <span class="token operator">==</span> key<span class="token punctuation">)</span>
    <span class="token punctuation">{</span><span class="token comment">// 找到key了</span>
        <span class="token keyword">return</span> node<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        root <span class="token operator">=</span> <span class="token class-name">ReadDisk</span><span class="token punctuation">(</span>node<span class="token operator">-&gt;</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 进行一次磁盘IO，将下一个节点读入到内存</span>
        <span class="token class-name">BTreeSearch</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 递归寻找</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="b-树如何迎合磁盘" tabindex="-1"><a class="header-anchor" href="#b-树如何迎合磁盘" aria-hidden="true">#</a> B 树如何迎合磁盘</h3><blockquote><p>本篇我们从“迎合”磁盘的角度来看看B树的设计。</p></blockquote><p><strong>索引的效率依赖于磁盘 IO 的次数，快速索引需要有效的减少磁盘 IO 次数</strong>。</p><blockquote><p>索引的原理？B树是如何快速索引的？</p></blockquote><p><strong>索引的原理其实是不断的缩小查找范围</strong>，就如我们平时用字典查单词一样，先找首字母缩小范围，再第二个字母等等。</p><p>平衡二叉树是每次将范围分割为两个区间。为了更快，<strong>B树每次将范围分割为多个区间，区间越多，定位数据越快越精确。那么如果节点为区间范围，每个节点就较大了</strong>。</p><p>实际设计中，<strong>我们把一个节点设为一个页</strong>，直接申请页大小的空间。（磁盘存储单位是按 block 分的，一般为 512 Byte。<strong>磁盘 IO 一次读取若干个 block，我们称为一页</strong>，具体大小和操作系统有关，一般为 4 k，8 k或 16 k）</p><p><strong>计算机内存分配是按页对齐的，这样就实现了一个节点只需要一次 IO。</strong></p><p><img src="https://pixel-revolve.oss-cn-hangzhou.aliyuncs.com/img/image-20220922100024467.png" alt="image-20220922100024467"></p><p>上图是一棵简化的B树，多叉的好处非常明显，有效的降低了B树的高度。现在的高度为底数很大的 log n，底数大小与节点的子节点数目有关，一般一棵B树的高度在 3 层左右。</p><p>层数低，每个节点区确定的范围更精确，范围缩小的速度越快（<strong>比二叉树深层次的搜索肯定快很多</strong>）。</p><p>上面说了一个节点需要进行一次 IO，那么总 IO 的次数就缩减为了 log n 次。</p><p>B树的每个节点是 n 个有序的序列$(a_1,a_2,a_3…a_n)$，并将该节点的子节点分割成 n+1 个区间来进行索引$(X_1&lt; a_1, a_2 &lt; X_2 &lt; a_3, … , a_{n+1} &lt; X_n &lt; a_n, X_{n+1} &gt; a_n)$。</p><blockquote><p>解释：B树的每个节点，都是存多个值的，不像二叉树那样，一个节点就一个值，B树把每个节点都给了一点的范围区间，区间更多的情况下，搜索也就更快了，比如：有1-100个数，二叉树一次只能分两个范围，0-50和51-100，而B树，分成4个范围 1-25， 25-50，51-75，76-100 <strong>一次就能筛选走四分之三的数据</strong>。所以作为多叉树的B树是更快的</p></blockquote><p>所以，B树就是一个很好的索引结构，因为它有效的减少了磁盘 IO 次数！</p><h3 id="b-树代码实现" tabindex="-1"><a class="header-anchor" href="#b-树代码实现" aria-hidden="true">#</a> B 树代码实现</h3><blockquote><p>本篇代码引用自：</p><p>https://github.com/tclxspy/Articles/blob/master/algorithm/MD/%E7%AE%97%E6%B3%95%2316--B%E6%A0%91%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81Java%E5%AE%9E%E7%8E%B0.md</p></blockquote><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BTree</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Key</span> <span class="token keyword">extends</span> <span class="token class-name">Comparable</span><span class="token punctuation">&lt;</span><span class="token class-name">Key</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">Value</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">{</span>
    <span class="token comment">// max children per B-tree node = M-1</span>
    <span class="token comment">// (must be even and greater than 2)</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token class-name">M</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Node</span> root<span class="token punctuation">;</span>       <span class="token comment">// root of the B-tree</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> height<span class="token punctuation">;</span>      <span class="token comment">// height of the B-tree</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> n<span class="token punctuation">;</span>           <span class="token comment">// number of key-value pairs in the B-tree</span>

    <span class="token comment">// helper B-tree node data type</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Node</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> m<span class="token punctuation">;</span>                             <span class="token comment">// number of children</span>
        <span class="token keyword">private</span> <span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> children <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token class-name">M</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">// the array of children</span>

        <span class="token comment">// create a node with k children</span>
        <span class="token keyword">private</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            m <span class="token operator">=</span> k<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// internal nodes: only use key and next</span>
    <span class="token comment">// external nodes: only use key and value</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Entry</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token class-name">Comparable</span> key<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">Object</span> val<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">Node</span> next<span class="token punctuation">;</span>     <span class="token comment">// helper field to iterate over array entries</span>
        <span class="token keyword">public</span> <span class="token class-name">Entry</span><span class="token punctuation">(</span><span class="token class-name">Comparable</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span> val<span class="token punctuation">,</span> <span class="token class-name">Node</span> next<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>key  <span class="token operator">=</span> key<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>val  <span class="token operator">=</span> val<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>next <span class="token operator">=</span> next<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * Initializes an empty B-tree.
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">BTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        root <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * Returns true if this symbol table is empty.
     * <span class="token keyword">@return</span> <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token boolean">true</span></span></span><span class="token punctuation">}</span> if this symbol table is empty; <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token boolean">false</span></span></span><span class="token punctuation">}</span> otherwise
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * Returns the number of key-value pairs in this symbol table.
     * <span class="token keyword">@return</span> the number of key-value pairs in this symbol table
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> n<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * Returns the height of this B-tree (for debugging).
     *
     * <span class="token keyword">@return</span> the height of this B-tree
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> height<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token doc-comment comment">/**
     * Returns the value associated with the given key.
     *
     * <span class="token keyword">@param</span>  <span class="token parameter">key</span> the key
     * <span class="token keyword">@return</span> the value associated with the given key if the key is in the symbol table
     *         and <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token keyword">null</span></span></span><span class="token punctuation">}</span> if the key is not in the symbol table
     * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">NullPointerException</span></span> if <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java">key</span></span><span class="token punctuation">}</span> is <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token keyword">null</span></span></span><span class="token punctuation">}</span>
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Value</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Key</span> key<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token string">&quot;key must not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">search</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> key<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Value</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token class-name">Node</span> x<span class="token punctuation">,</span> <span class="token class-name">Key</span> key<span class="token punctuation">,</span> <span class="token keyword">int</span> ht<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> children <span class="token operator">=</span> x<span class="token punctuation">.</span>children<span class="token punctuation">;</span>

        <span class="token comment">// external node到最底层叶子结点，遍历</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ht <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> x<span class="token punctuation">.</span>m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">eq</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Value</span><span class="token punctuation">)</span> children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>val<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// internal node递归查找next地址</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> x<span class="token punctuation">.</span>m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">1</span> <span class="token operator">==</span> x<span class="token punctuation">.</span>m <span class="token operator">||</span> <span class="token function">less</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> children<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token function">search</span><span class="token punctuation">(</span>children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">,</span> key<span class="token punctuation">,</span> ht<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token doc-comment comment">/**
     * Inserts the key-value pair into the symbol table, overwriting the old value
     * with the new value if the key is already in the symbol table.
     * If the value is <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token keyword">null</span></span></span><span class="token punctuation">}</span>, this effectively deletes the key from the symbol table.
     *
     * <span class="token keyword">@param</span>  <span class="token parameter">key</span> the key
     * <span class="token keyword">@param</span>  <span class="token parameter">val</span> the value
     * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">NullPointerException</span></span> if <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java">key</span></span><span class="token punctuation">}</span> is <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token keyword">null</span></span></span><span class="token punctuation">}</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Key</span> key<span class="token punctuation">,</span> <span class="token class-name">Value</span> val<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token string">&quot;key must not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">Node</span> u <span class="token operator">=</span> <span class="token function">insert</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//分裂后生成的右结点</span>
        n<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// need to split root重组root</span>
        <span class="token class-name">Node</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> root<span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> u<span class="token punctuation">)</span><span class="token punctuation">;</span>
        root <span class="token operator">=</span> t<span class="token punctuation">;</span>
        height<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">Node</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">Node</span> h<span class="token punctuation">,</span> <span class="token class-name">Key</span> key<span class="token punctuation">,</span> <span class="token class-name">Value</span> val<span class="token punctuation">,</span> <span class="token keyword">int</span> ht<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> j<span class="token punctuation">;</span>
        <span class="token class-name">Entry</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> val<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// external node外部结点，也是叶子结点，在树的最底层，存的是内容value</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ht <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> h<span class="token punctuation">.</span>m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">less</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> h<span class="token punctuation">.</span>children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// internal node内部结点，存的是next地址</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> h<span class="token punctuation">.</span>m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">1</span> <span class="token operator">==</span> h<span class="token punctuation">.</span>m<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">less</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> h<span class="token punctuation">.</span>children<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token class-name">Node</span> u <span class="token operator">=</span> <span class="token function">insert</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>children<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val<span class="token punctuation">,</span> ht<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{</span>
                        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    t<span class="token punctuation">.</span>key <span class="token operator">=</span> u<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">;</span>
                    t<span class="token punctuation">.</span>next <span class="token operator">=</span> u<span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> h<span class="token punctuation">.</span>m<span class="token punctuation">;</span> i <span class="token operator">&gt;</span> j<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            h<span class="token punctuation">.</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> h<span class="token punctuation">.</span>children<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        h<span class="token punctuation">.</span>children<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>
        h<span class="token punctuation">.</span>m<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>h<span class="token punctuation">.</span>m <span class="token operator">&lt;</span> <span class="token class-name">M</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>	<span class="token comment">//分裂结点</span>
            <span class="token keyword">return</span> <span class="token function">split</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// split node in half</span>
    <span class="token keyword">private</span> <span class="token class-name">Node</span> <span class="token function">split</span><span class="token punctuation">(</span><span class="token class-name">Node</span> h<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">Node</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token class-name">M</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        h<span class="token punctuation">.</span>m <span class="token operator">=</span> <span class="token class-name">M</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token class-name">M</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            t<span class="token punctuation">.</span>children<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> h<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token class-name">M</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> t<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * Returns a string representation of this B-tree (for debugging).
     *
     * <span class="token keyword">@return</span> a string representation of this B-tree.
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">toString</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> height<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token class-name">Node</span> h<span class="token punctuation">,</span> <span class="token keyword">int</span> ht<span class="token punctuation">,</span> <span class="token class-name">String</span> indent<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">StringBuilder</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> children <span class="token operator">=</span> h<span class="token punctuation">.</span>children<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>ht <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> h<span class="token punctuation">.</span>m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                s<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>indent <span class="token operator">+</span> children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>key <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> h<span class="token punctuation">.</span>m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    s<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>indent <span class="token operator">+</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">+</span> children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>key <span class="token operator">+</span> <span class="token string">&quot;)\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                s<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">toString</span><span class="token punctuation">(</span>children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">,</span> ht<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> indent <span class="token operator">+</span> <span class="token string">&quot;     &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">// comparison functions - make Comparable instead of Key to avoid casts</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">less</span><span class="token punctuation">(</span><span class="token class-name">Comparable</span> k1<span class="token punctuation">,</span> <span class="token class-name">Comparable</span> k2<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> k1<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>k2<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">Comparable</span> k1<span class="token punctuation">,</span> <span class="token class-name">Comparable</span> k2<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> k1<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>k2<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br></div></div><h2 id="b-树-1" tabindex="-1"><a class="header-anchor" href="#b-树-1" aria-hidden="true">#</a> B+ 树</h2><blockquote><p>在了解完成B树以后我们就来讲讲看B+树</p></blockquote><h3 id="b-树的操作-1" tabindex="-1"><a class="header-anchor" href="#b-树的操作-1" aria-hidden="true">#</a> B+ 树的操作</h3><h4 id="查找-1" tabindex="-1"><a class="header-anchor" href="#查找-1" aria-hidden="true">#</a> 查找</h4><p>首先，Ｂ＋树的查找和Ｂ树一样，类似于二叉查找树。起始于根节点，自顶向下遍历树，选择其分离值在要查找值的任意一边的子指针。在节点内部典型的使用是二分查找来确定这个位置。</p><blockquote><p>结合我们的卫星数据的概念，我们再一次剖析一下B+树的查找</p></blockquote><blockquote><p><strong>B+树的优势在于查找效率和稳定性</strong></p></blockquote><ul><li>B+ 树中间节点没有<strong>卫星数据</strong>（索引元素所指向的数据记录），只有索引，而Ｂ树每个结点中的每个关键字都有卫星数据；这就意味着同样的大小的磁盘页B+树可以容纳更多节点元素。<strong>在相同的数据量下，Ｂ+ 树更加“矮胖”，IO操作更少。</strong></li><li>B树的查找性能并不稳定（最好情况只查询根节点，最坏情况是查找叶子节点）。而B+树的每一次查找都是稳定的，每次都是根据索引查询到叶子。</li></ul><blockquote><p>单行查询</p></blockquote><p>一般的查找和B树并没有太大区别，只是B+树要找到链表为止。</p><blockquote><p>在 「AVL树 vs B树 vs B+树」一章中我们讲了B+树更便于范围查询，于是我们接着就来讲范围查询</p></blockquote><blockquote><p><strong>范围查询</strong></p></blockquote><ul><li><blockquote><p>B树的范围查询</p><p>查询范围：[3, 9]</p><p>方式：利用平衡树中序遍历有序的性质。</p></blockquote><p>自定向下，查找到范围下限 3</p><p><img src="https://pixel-revolve.oss-cn-hangzhou.aliyuncs.com/img/image-20220922135658901.png" alt="image-20220922135658901"></p><p>中序遍历到5</p><p><img src="https://pixel-revolve.oss-cn-hangzhou.aliyuncs.com/img/image-20220922135950283.png" alt="image-20220922135950283"></p><p>中序遍历到6</p><p><img src="https://pixel-revolve.oss-cn-hangzhou.aliyuncs.com/img/image-20220922140017888.png" alt="image-20220922140017888"></p><p>中序遍历到8</p><p><img src="https://pixel-revolve.oss-cn-hangzhou.aliyuncs.com/img/image-20220922140043155.png" alt="image-20220922140043155"></p><p>中序遍历到上限9，结束</p><p><img src="https://pixel-revolve.oss-cn-hangzhou.aliyuncs.com/img/image-20220922140122920.png" alt="image-20220922140122920"></p></li><li><blockquote><p>B+ 树的范围查询</p><p>查询范围：[3, 9]</p></blockquote><p>自定向下，查找到范围下限 3</p><p><img src="https://pixel-revolve.oss-cn-hangzhou.aliyuncs.com/img/image-20220922140254423.png" alt="image-20220922140254423"></p><p>通过链表指针，遍历到9</p><p><img src="https://pixel-revolve.oss-cn-hangzhou.aliyuncs.com/img/image-20220922140542694.png" alt="image-20220922140542694"></p></li></ul><p>所以这里就能很清楚的理解为什么说B+树更加适合范围查询了。</p><h3 id="b-树代码实现-1" tabindex="-1"><a class="header-anchor" href="#b-树代码实现-1" aria-hidden="true">#</a> B+ 树代码实现</h3><blockquote><p>本篇代码引用自: https://blog.csdn.net/nandao158/article/details/115701213</p></blockquote><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CatalogBTree</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Key</span> <span class="token keyword">extends</span> <span class="token class-name">Comparable</span><span class="token punctuation">&lt;</span><span class="token class-name">Key</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">Value</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
 
    <span class="token comment">//参数M 定义每个节点的链接数</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token class-name">M</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
 
    <span class="token keyword">private</span> <span class="token class-name">Node</span> root<span class="token punctuation">;</span>
 
    <span class="token comment">//树的高度  最底层为0 表示外部节点    根具有最大高度，此高度是根之后的高度</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> height<span class="token punctuation">;</span>
 
    <span class="token comment">//键值对总数</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> n<span class="token punctuation">;</span>
 
    <span class="token comment">//节点数据结构定义</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token punctuation">{</span>
        <span class="token comment">//值的数量</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> m<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> children <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token class-name">M</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span><span class="token punctuation">{</span>
            m <span class="token operator">=</span> k<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
 
    <span class="token comment">//节点内部每个数据项定义</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Entry</span><span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token class-name">Comparable</span> key<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Object</span> val<span class="token punctuation">;</span>
        <span class="token comment">//下一个节点</span>
        <span class="token keyword">private</span> <span class="token class-name">Node</span> next<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token class-name">Entry</span><span class="token punctuation">(</span><span class="token class-name">Comparable</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span> val<span class="token punctuation">,</span> <span class="token class-name">Node</span> next<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">=</span> val<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>next <span class="token operator">=</span> next<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">StringBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;Entry [key=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
 
    <span class="token punctuation">}</span>
 
    <span class="token keyword">public</span> <span class="token class-name">CatalogBTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        root <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> n<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> height<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token doc-comment comment">/**
     * 查询接口
     * <span class="token keyword">@param</span> <span class="token parameter">key</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Value</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Key</span> key<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">search</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> key<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">private</span> <span class="token class-name">Value</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token class-name">Node</span> x<span class="token punctuation">,</span> <span class="token class-name">Key</span> key<span class="token punctuation">,</span> <span class="token keyword">int</span> ht<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> children <span class="token operator">=</span> x<span class="token punctuation">.</span>children<span class="token punctuation">;</span><span class="token comment">//首次进入，相当于根节点</span>
        <span class="token comment">//外部节点  这里使用顺序查找</span>
        <span class="token comment">//如果M很大  可以改成二分查找</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>ht <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//到了有数据的子节点（也可能是根节点，如果键值对小于M），此次查询数据。</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>x<span class="token punctuation">.</span>m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">equal</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> x<span class="token punctuation">.</span>children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//遍历查询</span>
                    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Value</span><span class="token punctuation">)</span>children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>val<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//内部节点  寻找下一个节点</span>
        <span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>x<span class="token punctuation">.</span>m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token comment">//最后一个节点  或者 插入值小于某个孩子节点值</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token operator">==</span>x<span class="token punctuation">.</span>m <span class="token operator">||</span> <span class="token function">less</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> x<span class="token punctuation">.</span>children<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//定位数据在哪个节点下，然后继续递归查询</span>
                    <span class="token keyword">return</span> <span class="token function">search</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">,</span> key<span class="token punctuation">,</span> ht<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//去下一层继续查询</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token doc-comment comment">/**
     * 新增数据接口
     * <span class="token keyword">@param</span> <span class="token parameter">key</span>
     * <span class="token keyword">@param</span> <span class="token parameter">val</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Key</span> key<span class="token punctuation">,</span> <span class="token class-name">Value</span> val<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//插入后的节点，如果节点分裂，则返回分裂后产生的新节点</span>
        <span class="token class-name">Node</span> u <span class="token operator">=</span> <span class="token function">insert</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
        n<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//键值对总数加一</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>u <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token comment">//根节点没有分裂  直接返回</span>
        <span class="token comment">//分裂根节点,已满节点进行分裂，将已满节点后M/2节点生成一个新节点，并将新节点的第一个元素指向父节点，此处是M&gt;&gt;1 = 2（因为M=4）</span>
        <span class="token class-name">Node</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token class-name">M</span><span class="token operator">&gt;&gt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//旧根节点第一个孩子和新分裂节点第一个孩子 共同 组成新节点作为根</span>
        t<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> root<span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> u<span class="token punctuation">)</span><span class="token punctuation">;</span>
        root <span class="token operator">=</span> t<span class="token punctuation">;</span><span class="token comment">//新的根节点</span>
        height<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//节点高度加1</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">private</span> <span class="token class-name">Node</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">Node</span> h<span class="token punctuation">,</span> <span class="token class-name">Key</span> key<span class="token punctuation">,</span> <span class="token class-name">Value</span> val<span class="token punctuation">,</span> <span class="token keyword">int</span> ht<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> j<span class="token punctuation">;</span>
        <span class="token comment">//新建待插入数据数据项</span>
        <span class="token class-name">Entry</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> val<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>ht <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//高度为零时，直接遍历</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>h<span class="token punctuation">.</span>m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 外部节点  找到带插入的节点位置j</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">less</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> h<span class="token punctuation">.</span>children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token comment">//内部节点  找到合适的分支节点</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>h<span class="token punctuation">.</span>m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token operator">==</span>h<span class="token punctuation">.</span>m <span class="token operator">||</span> <span class="token function">less</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> h<span class="token punctuation">.</span>children<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token class-name">Node</span> u <span class="token operator">=</span> <span class="token function">insert</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>children<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val<span class="token punctuation">,</span> ht<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>u <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                    t<span class="token punctuation">.</span>key <span class="token operator">=</span> u<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">;</span>
                    t<span class="token punctuation">.</span>next <span class="token operator">=</span> u<span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//j为带插入位置，将顺序数组j位置以后后移一位(从后往前处理) 将t插入</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>h<span class="token punctuation">.</span>m<span class="token punctuation">;</span> i<span class="token operator">&gt;</span>j<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            h<span class="token punctuation">.</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> h<span class="token punctuation">.</span>children<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>j <span class="token operator">+</span> t<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        h<span class="token punctuation">.</span>children<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span><span class="token comment">//此处插入成功</span>
        h<span class="token punctuation">.</span>m<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//值的数量加一</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>m <span class="token operator">&lt;</span> <span class="token class-name">M</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token comment">//如果节点已满  则执行分类操作（从根节点开始）</span>
        <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token function">split</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">private</span> <span class="token class-name">Node</span> <span class="token function">split</span><span class="token punctuation">(</span><span class="token class-name">Node</span> h<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//将已满节点h的后，一般M/2节点后的节点分裂到新节点并返回</span>
        <span class="token class-name">Node</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token class-name">M</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        h<span class="token punctuation">.</span>m <span class="token operator">=</span> <span class="token class-name">M</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token class-name">M</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            t<span class="token punctuation">.</span>children<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> h<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token class-name">M</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//把h节点中M/2节点后的节点分裂到新节点</span>
            h<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token class-name">M</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token comment">//把h节点中M/2节点后的节点设置为空，以尽快GC</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> t<span class="token punctuation">;</span><span class="token comment">//返回新节点</span>
    <span class="token punctuation">}</span>
 
    <span class="token doc-comment comment">/**
     * 删除数据
     * <span class="token keyword">@param</span> <span class="token parameter">key</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">Key</span> key<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">remove</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> key<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    <span class="token punctuation">}</span>
 
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">Node</span> x<span class="token punctuation">,</span> <span class="token class-name">Key</span> key<span class="token punctuation">,</span> <span class="token keyword">int</span> ht<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> children <span class="token operator">=</span> x<span class="token punctuation">.</span>children<span class="token punctuation">;</span><span class="token comment">//首次进入，相当于根节点</span>
        <span class="token comment">//外部节点  这里使用顺序查找</span>
        <span class="token comment">//如果M很大  可以改成二分查找</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>ht <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//到了有数据的子节点（也可能是根节点，如果键值对小于M），此次查询数据。</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>x<span class="token punctuation">.</span>m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">equal</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> x<span class="token punctuation">.</span>children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//遍历查询</span>
                    children<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token comment">//删除此节点数据</span>
                    x<span class="token punctuation">.</span>m<span class="token operator">--</span><span class="token punctuation">;</span><span class="token comment">//值的数量减一</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//内部节点  寻找下一个节点</span>
        <span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>x<span class="token punctuation">.</span>m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token comment">//最后一个节点  或者 插入值小于某个孩子节点值</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token operator">==</span>x<span class="token punctuation">.</span>m <span class="token operator">||</span> <span class="token function">less</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> x<span class="token punctuation">.</span>children<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//定位数据在哪个节点下，然后继续递归查询</span>
                     <span class="token function">remove</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">,</span> key<span class="token punctuation">,</span> ht<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//去下一层继续查询</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">equal</span><span class="token punctuation">(</span><span class="token class-name">Comparable</span> k1<span class="token punctuation">,</span> <span class="token class-name">Comparable</span> k2<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> k1<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>k2<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">less</span><span class="token punctuation">(</span><span class="token class-name">Comparable</span> k1<span class="token punctuation">,</span> <span class="token class-name">Comparable</span> k2<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> k1<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>k2<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">toString</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> height<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token class-name">Node</span> h<span class="token punctuation">,</span> <span class="token keyword">int</span> ht<span class="token punctuation">,</span> <span class="token class-name">String</span> indent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">StringBuilder</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> children <span class="token operator">=</span> h<span class="token punctuation">.</span>children<span class="token punctuation">;</span><span class="token comment">//此数据相当于根节点</span>
 
        <span class="token comment">//外部节点</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ht <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> h<span class="token punctuation">.</span>m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                s<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>indent <span class="token operator">+</span> children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>key <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> h<span class="token punctuation">.</span>m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                s<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>indent <span class="token operator">+</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">+</span> children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>key <span class="token operator">+</span> <span class="token string">&quot;)\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                s<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">toString</span><span class="token punctuation">(</span>children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">,</span> ht<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> indent <span class="token operator">+</span> <span class="token string">&quot;     &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br></div></div><h1 id="功能测试" tabindex="-1"><a class="header-anchor" href="#功能测试" aria-hidden="true">#</a> 功能测试</h1><blockquote><p>本篇代码引用自：</p><p>https://github.com/tclxspy/Articles/blob/master/algorithm/MD/%E7%AE%97%E6%B3%95%2316--B%E6%A0%91%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81Java%E5%AE%9E%E7%8E%B0.md</p><p>https://blog.csdn.net/nandao158/article/details/115701213</p></blockquote><blockquote><p>B 树</p></blockquote><p>测试建树：</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestBTree</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testCreateTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">BTree</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> st <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BTree</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        st<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;www.cs.princeton.edu&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;128.112.136.12&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        st<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;www.cs.princeton.edu&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;128.112.136.11&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        st<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;www.princeton.edu&quot;</span><span class="token punctuation">,</span>    <span class="token string">&quot;128.112.128.15&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        st<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;www.yale.edu&quot;</span><span class="token punctuation">,</span>         <span class="token string">&quot;130.132.143.21&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        st<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;www.simpsons.com&quot;</span><span class="token punctuation">,</span>     <span class="token string">&quot;209.052.165.60&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        st<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;www.apple.com&quot;</span><span class="token punctuation">,</span>        <span class="token string">&quot;17.112.152.32&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        st<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;www.amazon.com&quot;</span><span class="token punctuation">,</span>       <span class="token string">&quot;207.171.182.16&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        st<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;www.ebay.com&quot;</span><span class="token punctuation">,</span>         <span class="token string">&quot;66.135.192.87&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        st<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;www.cnn.com&quot;</span><span class="token punctuation">,</span>          <span class="token string">&quot;64.236.16.20&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        st<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;www.google.com&quot;</span><span class="token punctuation">,</span>       <span class="token string">&quot;216.239.41.99&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        st<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;www.nytimes.com&quot;</span><span class="token punctuation">,</span>      <span class="token string">&quot;199.239.136.200&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        st<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;www.microsoft.com&quot;</span><span class="token punctuation">,</span>    <span class="token string">&quot;207.126.99.140&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        st<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;www.dell.com&quot;</span><span class="token punctuation">,</span>         <span class="token string">&quot;143.166.224.230&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        st<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;www.slashdot.org&quot;</span><span class="token punctuation">,</span>     <span class="token string">&quot;66.35.250.151&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        st<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;www.espn.com&quot;</span><span class="token punctuation">,</span>         <span class="token string">&quot;199.181.135.201&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        st<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;www.weather.com&quot;</span><span class="token punctuation">,</span>      <span class="token string">&quot;63.111.66.11&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        st<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;www.yahoo.com&quot;</span><span class="token punctuation">,</span>        <span class="token string">&quot;216.109.118.65&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;cs.princeton.edu:  &quot;</span> <span class="token operator">+</span> st<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;www.cs.princeton.edu&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;hardvardsucks.com: &quot;</span> <span class="token operator">+</span> st<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;www.harvardsucks.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;simpsons.com:      &quot;</span> <span class="token operator">+</span> st<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;www.simpsons.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;apple.com:         &quot;</span> <span class="token operator">+</span> st<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;www.apple.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ebay.com:          &quot;</span> <span class="token operator">+</span> st<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;www.ebay.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;dell.com:          &quot;</span> <span class="token operator">+</span> st<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;www.dell.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;size:    &quot;</span> <span class="token operator">+</span> st<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;height:  &quot;</span> <span class="token operator">+</span> st<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>测试结果：</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>cs<span class="token punctuation">.</span>princeton<span class="token punctuation">.</span>edu<span class="token operator">:</span>  <span class="token number">128.112</span><span class="token number">.136</span><span class="token number">.12</span>
hardvardsucks<span class="token punctuation">.</span>com<span class="token operator">:</span> <span class="token keyword">null</span>
simpsons<span class="token punctuation">.</span>com<span class="token operator">:</span>      <span class="token number">209.052</span><span class="token number">.165</span><span class="token number">.60</span>
apple<span class="token punctuation">.</span>com<span class="token operator">:</span>         <span class="token number">17.112</span><span class="token number">.152</span><span class="token number">.32</span>
ebay<span class="token punctuation">.</span>com<span class="token operator">:</span>          <span class="token number">66.135</span><span class="token number">.192</span><span class="token number">.87</span>
dell<span class="token punctuation">.</span>com<span class="token operator">:</span>          <span class="token number">143.166</span><span class="token number">.224</span><span class="token number">.230</span>

size<span class="token operator">:</span>    <span class="token number">17</span>
height<span class="token operator">:</span>  <span class="token number">2</span>
          www<span class="token punctuation">.</span>amazon<span class="token punctuation">.</span>com <span class="token number">207.171</span><span class="token number">.182</span><span class="token number">.16</span>
          www<span class="token punctuation">.</span>apple<span class="token punctuation">.</span>com <span class="token number">17.112</span><span class="token number">.152</span><span class="token number">.32</span>
          www<span class="token punctuation">.</span>cnn<span class="token punctuation">.</span>com <span class="token number">64.236</span><span class="token number">.16</span><span class="token number">.20</span>
     <span class="token punctuation">(</span>www<span class="token punctuation">.</span>cs<span class="token punctuation">.</span>princeton<span class="token punctuation">.</span>edu<span class="token punctuation">)</span>
          www<span class="token punctuation">.</span>cs<span class="token punctuation">.</span>princeton<span class="token punctuation">.</span>edu <span class="token number">128.112</span><span class="token number">.136</span><span class="token number">.12</span>
          www<span class="token punctuation">.</span>cs<span class="token punctuation">.</span>princeton<span class="token punctuation">.</span>edu <span class="token number">128.112</span><span class="token number">.136</span><span class="token number">.11</span>
          www<span class="token punctuation">.</span>dell<span class="token punctuation">.</span>com <span class="token number">143.166</span><span class="token number">.224</span><span class="token number">.230</span>
<span class="token punctuation">(</span>www<span class="token punctuation">.</span>ebay<span class="token punctuation">.</span>com<span class="token punctuation">)</span>
          www<span class="token punctuation">.</span>ebay<span class="token punctuation">.</span>com <span class="token number">66.135</span><span class="token number">.192</span><span class="token number">.87</span>
          www<span class="token punctuation">.</span>espn<span class="token punctuation">.</span>com <span class="token number">199.181</span><span class="token number">.135</span><span class="token number">.201</span>
          www<span class="token punctuation">.</span>google<span class="token punctuation">.</span>com <span class="token number">216.239</span><span class="token number">.41</span><span class="token number">.99</span>
     <span class="token punctuation">(</span>www<span class="token punctuation">.</span>microsoft<span class="token punctuation">.</span>com<span class="token punctuation">)</span>
          www<span class="token punctuation">.</span>microsoft<span class="token punctuation">.</span>com <span class="token number">207.126</span><span class="token number">.99</span><span class="token number">.140</span>
          www<span class="token punctuation">.</span>nytimes<span class="token punctuation">.</span>com <span class="token number">199.239</span><span class="token number">.136</span><span class="token number">.200</span>
<span class="token punctuation">(</span>www<span class="token punctuation">.</span>princeton<span class="token punctuation">.</span>edu<span class="token punctuation">)</span>
          www<span class="token punctuation">.</span>princeton<span class="token punctuation">.</span>edu <span class="token number">128.112</span><span class="token number">.128</span><span class="token number">.15</span>
          www<span class="token punctuation">.</span>simpsons<span class="token punctuation">.</span>com <span class="token number">209.052</span><span class="token number">.165</span><span class="token number">.60</span>
     <span class="token punctuation">(</span>www<span class="token punctuation">.</span>slashdot<span class="token punctuation">.</span>org<span class="token punctuation">)</span>
          www<span class="token punctuation">.</span>slashdot<span class="token punctuation">.</span>org <span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.151</span>
          www<span class="token punctuation">.</span>weather<span class="token punctuation">.</span>com <span class="token number">63.111</span><span class="token number">.66</span><span class="token number">.11</span>
     <span class="token punctuation">(</span>www<span class="token punctuation">.</span>yahoo<span class="token punctuation">.</span>com<span class="token punctuation">)</span>
          www<span class="token punctuation">.</span>yahoo<span class="token punctuation">.</span>com <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.65</span>
          www<span class="token punctuation">.</span>yale<span class="token punctuation">.</span>edu <span class="token number">130.132</span><span class="token number">.143</span><span class="token number">.21</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><blockquote><p>B+ 树</p></blockquote><p>测试建树：</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestCatalogBTree</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testCreateTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token doc-comment comment">/**
         * 添加的顺序不同，最后树的结构也不同
         */</span>
        <span class="token class-name">CatalogBTree</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> bt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CatalogBTree</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//     bt.put(9,&quot;c&quot;);</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token string">&quot;d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token string">&quot;e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//     bt.put(18,&quot;f&quot;);</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token string">&quot;g&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token string">&quot;h&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//      bt.put(27,&quot;i&quot;);</span>

        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token string">&quot;i&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token string">&quot;j&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//      bt.put(33,&quot;k&quot;);</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token string">&quot;l&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token string">&quot;m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//    bt.put(50,&quot;n&quot;);</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token string">&quot;o&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token string">&quot;p&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//      bt.put(63,&quot;q&quot;);</span>

        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token string">&quot;r&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">73</span><span class="token punctuation">,</span><span class="token string">&quot;s&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//       bt.put(79,&quot;t&quot;);</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token string">&quot;u&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">85</span><span class="token punctuation">,</span><span class="token string">&quot;v&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//   bt.put(88,&quot;w&quot;);</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">96</span><span class="token punctuation">,</span><span class="token string">&quot;y&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token string">&quot;z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token doc-comment comment">/**
         * 插入第三个元素
         */</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token string">&quot;f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token string">&quot;i&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token string">&quot;k&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">&quot;n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token string">&quot;q&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">79</span><span class="token punctuation">,</span><span class="token string">&quot;t&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;高度：&quot;</span><span class="token operator">+</span>bt<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;查询：&quot;</span><span class="token operator">+</span>bt<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span> bt<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div><p>测试结果：</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token number">0</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">]</span>
<span class="token number">1</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">]</span>
<span class="token number">3</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">]</span>
<span class="token number">3</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">26</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">28</span><span class="token punctuation">]</span>
<span class="token number">3</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">]</span>
<span class="token number">3</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">28</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">35</span><span class="token punctuation">]</span>
<span class="token number">3</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">38</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">35</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">56</span><span class="token punctuation">]</span>
<span class="token number">3</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">]</span>
<span class="token number">3</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">56</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">35</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">65</span><span class="token punctuation">]</span>
<span class="token number">3</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">73</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">65</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">]</span>
<span class="token number">3</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">85</span><span class="token punctuation">]</span>
<span class="token number">3</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">]</span>
<span class="token number">3</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">65</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">]</span>
<span class="token number">3</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">96</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">99</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">18</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">33</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">63</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">79</span><span class="token punctuation">]</span>
<span class="token number">2</span>Entry <span class="token punctuation">[</span>key<span class="token operator">=</span><span class="token number">88</span><span class="token punctuation">]</span>
高度：<span class="token number">3</span>
查询：c
<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
     <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
               <span class="token number">5</span> a
               <span class="token number">8</span> b
               <span class="token number">9</span> c
          <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
               <span class="token number">10</span> d
               <span class="token number">15</span> e
               <span class="token number">18</span> f
     <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
               <span class="token number">20</span> g
               <span class="token number">26</span> h
               <span class="token number">27</span> i
          <span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">)</span>
               <span class="token number">28</span> i
               <span class="token number">30</span> j
               <span class="token number">33</span> k
<span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">)</span>
     <span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">)</span>
               <span class="token number">35</span> l
               <span class="token number">38</span> m
               <span class="token number">50</span> n
          <span class="token punctuation">(</span><span class="token number">56</span><span class="token punctuation">)</span>
               <span class="token number">56</span> o
               <span class="token number">60</span> p
               <span class="token number">63</span> q
     <span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">)</span>
               <span class="token number">65</span> r
               <span class="token number">73</span> s
               <span class="token number">79</span> t
          <span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span>
               <span class="token number">80</span> u
               <span class="token number">85</span> v
               <span class="token number">88</span> w
          <span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span>
               <span class="token number">90</span> x
               <span class="token number">96</span> y
               <span class="token number">99</span> z
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br></div></div><h1 id="小结" tabindex="-1"><a class="header-anchor" href="#小结" aria-hidden="true">#</a> 小结</h1><p>不得不说，B树以及B+树的内容还是挺多的，写这篇文章也花了我挺多精力和时间的。不过看完这篇文章以后，面对面试官 ”说说看B或B+树吧“ 的问题，应该是有得一聊了。</p><p>本篇代码已同步上传至我的开源仓库：https://github.com/pixel-revolve/forest</p><p>本文参考：</p><ul><li>https://zhuanlan.zhihu.com/p/54102723</li><li>https://juejin.cn/post/6844903613915987975#heading-1</li><li>https://mp.weixin.qq.com/s/jUTmb4FHITMYrDAhponTKg</li><li>https://www.jianshu.com/p/ace3cd6526c4</li><li>https://blog.csdn.net/qq_21989927/article/details/108881401</li><li>https://www.jianshu.com/p/e3506cee4010</li><li>https://blog.csdn.net/u011919863/article/details/78412698</li><li>https://blog.csdn.net/wwh578867817/article/details/50493940</li><li>https://developer.aliyun.com/article/748583</li><li>https://juejin.cn/post/6926315573185871879</li><li>https://blog.csdn.net/nandao158/article/details/115701213</li></ul><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><!----></footer><!----><!--[--><!--]--><!----></main><ul class="catalog" style="top:0px;"><li class="level-2 toc-link-什么是b树-b-树">什么是B树，B+树？</li><li class="level-2 toc-link-b树-b-树的使用场景">B树，B+树的使用场景</li><li class="level-2 toc-link-磁盘概述">磁盘概述</li><li class="level-2 toc-link-为什么使用b-b-树">为什么使用B，B+树？</li><li class="level-2 toc-link-卫星数据">卫星数据</li><li class="level-2 toc-link-b-树">B 树</li><li class="level-3 toc-link-_23树-234树">23树，234树</li><li class="level-3 toc-link-b-树的操作">B 树的操作</li><li class="level-3 toc-link-b-树如何迎合磁盘">B 树如何迎合磁盘</li><li class="level-3 toc-link-b-树代码实现">B 树代码实现</li><li class="level-2 toc-link-b-树-1">B+ 树</li><li class="level-3 toc-link-b-树的操作-1">B+ 树的操作</li><li class="level-3 toc-link-b-树代码实现-1">B+ 树代码实现</li></ul></div><!--]--></div><div class="search-page" role="search"><span class="search-close"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" width="28" height="28" fill="currentColor"><path d="M224 416c-8.188 0-16.38-3.125-22.62-9.375l-192-192c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L224 338.8l169.4-169.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-192 192C240.4 412.9 232.2 416 224 416z"></path></svg></span><div class="gungnir-search-box"><input placeholder="$ grep ..." autocomplete="off" spellcheck="false" value><!----></div></div><div class="menu-btn-container"><div class="menu-btn-wrapper"><div class="menu-btn"><div style="" class="menu-btn-icon"><span></span><span></span><span></span></div><div style="display:none;" class="menu-text">0</div><svg class="menu-progress"><circle class="menu-border" cx="50%" cy="50%" r="48%" style="stroke-dasharray:0% 314.15926%;"></circle></svg></div><div class="menu-btn-child-wrapper"><div class="toggle-dark-button menu-btn-child" title="toggle dark mode"><svg class="ov-icon" style="font-size:1.2em;display:none;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"/></svg><svg class="ov-icon" style="font-size:1.2em;display:none;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 00283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"/></svg><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M224 96l16-32 32-16-32-16-16-32-16 32-32 16 32 16 16 32zM80 160l26.66-53.33L160 80l-53.34-26.67L80 0 53.34 53.33 0 80l53.34 26.67L80 160zm352 128l-26.66 53.33L352 368l53.34 26.67L432 448l26.66-53.33L512 368l-53.34-26.67L432 288zm70.62-193.77L417.77 9.38C411.53 3.12 403.34 0 395.15 0c-8.19 0-16.38 3.12-22.63 9.38L9.38 372.52c-12.5 12.5-12.5 32.76 0 45.25l84.85 84.85c6.25 6.25 14.44 9.37 22.62 9.37 8.19 0 16.38-3.12 22.63-9.37l363.14-363.15c12.5-12.48 12.5-32.75 0-45.24zM359.45 203.46l-50.91-50.91 86.6-86.6 50.91 50.91-86.6 86.6z"/></svg></div><div class="menu-btn-child"><svg class="ov-icon" style="font-size:1.7999999999999998em;" aria-hidden="true" width="28.799999999999997" height="28.799999999999997" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg></div><div class="menu-btn-child"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg></div><div class="menu-btn-child menu-toc-btn"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M48 48a48 48 0 1048 48 48 48 0 00-48-48zm0 160a48 48 0 1048 48 48 48 0 00-48-48zm0 160a48 48 0 1048 48 48 48 0 00-48-48zm448 16H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16zm0-320H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16V80a16 16 0 00-16-16zm0 160H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16z"/></svg></div><div class="toggle-sidebar-button menu-btn-child menu-btn-sidebar" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-1.6 -1.6 19.2 19.2" fill="currentColor"><path d="M14 2a1 1 0 011 1v10a1 1 0 01-1 1H2a1 1 0 01-1-1V3a1 1 0 011-1h12zM2 1a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V3a2 2 0 00-2-2H2z"/><path d="M3 4a1 1 0 011-1h2a1 1 0 011 1v8a1 1 0 01-1 1H4a1 1 0 01-1-1V4z"/></svg></div></div></div></div><footer class="footer"><span>
                &copy; pixel-revolve 2021-2022
                <br>
                Powered by <a href="https://vuepress.vuejs.org" target="_blank">VuePress</a> &
                <a href="https://github.com/Renovamen/vuepress-theme-gungnir" target="_blank">Gungnir</a>
                </span></footer></div><!--]--></div>
    <script type="module" src="/assets/app.9fd9aa02.js" defer></script>
  </body>
</html>
